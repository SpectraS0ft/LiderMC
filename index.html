<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LiderMC Launcher with Settings</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@700&display=swap');
  body {
    font-family: 'Inter', sans-serif;
  }
</style>
</head>
<body class="min-h-screen bg-gradient-to-r from-[#4f6bf7] to-[#f25bc1] flex flex-col items-center justify-start p-6 transition-colors duration-500" id="body">
  <h1 id="welcomeText" class="text-white font-extrabold text-center text-4xl leading-tight max-w-xs sm:max-w-md mb-10">
    LiderMC<br />launcherga<br />hush kelibsiz
  </h1>

  <div class="mt-10 bg-gradient-to-r from-[#3498db] to-[#8a8ec1] rounded-3xl w-full max-w-md flex flex-col items-center py-16 px-8 relative">
    <a
      href="https://mcpehub.org/engine/getfile.php?id=43537"
      download
      class="bg-[#0db7d6] rounded-3xl w-full max-w-xs py-5 font-extrabold text-black mb-32 text-center block"
      >Minecraft yuklab olish</a
    >

    <button
      onclick="window.open('https://add.aternos.org/LiderMC_UZ', '_blank')"
      class="bg-[#0db7d6] rounded-3xl w-full max-w-xs py-5 font-extrabold text-black mb-8"
      type="button"
    >
      Serverni qo'shish
    </button>

    <p class="text-white font-extrabold text-center text-xl max-w-xs leading-snug">
      Server faqat yuqoridagi versiya uchun ishlaydi
    </p>

    <!-- Settings Button -->
    <button
      id="settingsBtn"
      aria-label="Settings"
      class="absolute top-4 right-4 bg-[#0db7d6] rounded-full w-12 h-12 flex items-center justify-center text-black text-2xl hover:bg-[#0aa5bb] transition-colors"
      title="Settings"
      type="button"
    >
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51h.09a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
    </button>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
    <div class="bg-white rounded-3xl max-w-md w-full p-6 relative">
      <h2 class="text-2xl font-extrabold mb-4 text-center">Settings</h2>
      <form id="settingsForm" class="flex flex-col space-y-4">
        <label class="flex flex-col text-gray-700 font-semibold">
          Ismingiz:
          <input
            type="text"
            id="nameInput"
            placeholder="Ismingizni kiriting"
            class="mt-1 p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0db7d6]"
          />
        </label>

        <label class="flex flex-col text-gray-700 font-semibold">
          Ilova rangi:
          <input
            type="color"
            id="colorInput"
            class="mt-1 w-20 h-10 p-0 border-0 cursor-pointer"
            title="Choose app color"
          />
        </label>

        <label class="flex flex-col text-gray-700 font-semibold">
          Profil rasmi (rasm URL yoki rasmni joylashtiring):
          <input
            type="file"
            id="profilePicInput"
            accept="image/*"
            class="mt-1"
          />
          <img
            id="profilePicPreview"
            alt="Profil rasmi oldindan ko'rish"
            class="mt-4 w-32 h-32 object-cover rounded-full border border-gray-300 hidden"
          />
        </label>

        <div class="flex justify-end space-x-4 pt-4">
          <button
            type="button"
            id="cancelBtn"
            class="px-4 py-2 rounded-lg bg-gray-300 font-semibold hover:bg-gray-400 transition"
          >
            Bekor qilish
          </button>
          <button
            type="submit"
            class="px-4 py-2 rounded-lg bg-[#0db7d6] text-black font-extrabold hover:bg-[#0aa5bb] transition"
          >
            Saqlash
          </button>
        </div>
      </form>
    </div>
  </div>

<script>
  const settingsBtn = document.getElementById('settingsBtn');
  const settingsModal = document.getElementById('settingsModal');
  const cancelBtn = document.getElementById('cancelBtn');
  const settingsForm = document.getElementById('settingsForm');
  const nameInput = document.getElementById('nameInput');
  const colorInput = document.getElementById('colorInput');
  const profilePicInput = document.getElementById('profilePicInput');
  const profilePicPreview = document.getElementById('profilePicPreview');
  const welcomeText = document.getElementById('welcomeText');
  const body = document.getElementById('body');

  // Load saved settings from localStorage
  function loadSettings() {
    const savedName = localStorage.getItem('userName');
    const savedColor = localStorage.getItem('appColor');
    const savedProfilePic = localStorage.getItem('profilePic');

    if (savedName) {
      nameInput.value = savedName;
      updateWelcomeText(savedName);
    }
    if (savedColor) {
      colorInput.value = savedColor;
      updateAppColor(savedColor);
    } else {
      // default color input value to match initial bg gradient start color
      colorInput.value = '#4f6bf7';
    }
    if (savedProfilePic) {
      profilePicPreview.src = savedProfilePic;
      profilePicPreview.classList.remove('hidden');
    }
  }

  // Update welcome text with name
  function updateWelcomeText(name) {
    welcomeText.innerHTML = `LiderMC<br />launcherga<br />hush kelibsiz<br /><span class="block mt-2 text-2xl">${name}</span>`;
  }

  // Update app background color gradient start color
  function updateAppColor(color) {
    // We keep the gradient from color to #f25bc1
    body.style.background = `linear-gradient(to right, ${color}, #f25bc1)`;
  }

  // Show modal
  settingsBtn.addEventListener('click', () => {
    settingsModal.classList.remove('hidden');
  });

  // Hide modal
  cancelBtn.addEventListener('click', () => {
    settingsModal.classList.add('hidden');
    loadSettings(); // reset inputs to saved values
  });

  // Preview profile picture on file select
  profilePicInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (!file) {
      profilePicPreview.src = '';
      profilePicPreview.classList.add('hidden');
      return;
    }
    const reader = new FileReader();
    reader.onload = function(event) {
      profilePicPreview.src = event.target.result;
      profilePicPreview.classList.remove('hidden');
    };
    reader.readAsDataURL(file);
  });

  // Save settings on form submit
  settingsForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = nameInput.value.trim();
    const color = colorInput.value;
    let profilePicData = profilePicPreview.src || '';

    if (name) {
      localStorage.setItem('userName', name);
      updateWelcomeText(name);
    } else {
      localStorage.removeItem('userName');
      welcomeText.innerHTML = `LiderMC<br />launcherga<br />hush kelibsiz`;
    }

    if (color) {
      localStorage.setItem('appColor', color);
      updateAppColor(color);
    }

    if (profilePicData && !profilePicData.startsWith('data:')) {
      // If preview src is not a data URL (e.g. empty or placeholder), remove from storage
      localStorage.removeItem('profilePic');
      profilePicPreview.classList.add('hidden');
    } else if (profilePicData) {
      localStorage.setItem('profilePic', profilePicData);
    } else {
      localStorage.removeItem('profilePic');
      profilePicPreview.classList.add('hidden');
    }

    settingsModal.classList.add('hidden');
  });

  // On page load, apply saved settings
  window.addEventListener('load', () => {
    loadSettings();
  });
</script>
</body>
</html>